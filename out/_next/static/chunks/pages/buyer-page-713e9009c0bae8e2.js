(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[967],{2242:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/buyer-page",function(){return a(3748)}])},3748:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var s=a(5893),n=a(7294);a(8306);let r=a(7066).Z.create({baseURL:"https://0sy7wxlvx0.execute-api.us-east-2.amazonaws.com/AuctionHouse"});function l(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[i,o]=(0,n.useState)(""),u=e=>{o(e)};(0,n.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("username");e&&l(e)},[]);let h=e=>{let t={username:document.getElementById("buyerUsername").innerText};console.log("Sending data:",t),r.post("/getBalance",t).then(function(e){400===e.data.statusCode?alert(e.data.error):200===e.data.statusCode&&c(e.data.value)}).catch(function(e){alert("Failed")})},m=e=>{r.post("/reviewPurchasesBuyer",{username:e}).then(e=>{200===e.data.statusCode?t(e.data.data):(console.log(e),alert(e.data.errorMessage))}).catch(()=>alert("Failed to review purchases"))},x=e=>{r.post("/reviewActiveBidsBuyer",{username:e}).then(e=>{200===e.data.statusCode?t(e.data.data):(console.log(e),alert(e.data.errorMessage))}).catch(()=>alert("Failed to review active bids"))},b=e=>{r.post("/searchRecentlySoldBuyer",{username:e}).then(e=>{200===e.data.statusCode?t(e.data.data):(console.log(e),alert(e.data.errorMessage))}).catch(()=>alert("Failed to search recently sold items"))},y=e=>{r.post("/sortRecentlySoldBuyer",{sortType:e}).then(e=>{200===e.data.statusCode?t(e.data.data):(console.log(e),alert(e.data.error))}).catch(()=>alert("Failed to sort recently sold items"))},j=e=>{let t=parseFloat(document.getElementById("buyerBalance").innerText.replace("$","")),s=CSS.escape(e),n=document.querySelector("#".concat(s)).value;if(1>Number(n)||!Number.isInteger(Number(n)))return alert("Must enter a WHOLE number that is AT LEAST 1");r.post("/placeBidBuyer",{itemID:e,buyerBalance:t,buyerUsername:a,dollarAmountBid:n}).then(e=>{200===e.data.statusCode?(alert("Bid successfully placed"),g("")):(console.log(e),alert(e.data.error))}).catch(()=>alert("Failed to bid on item."))},N=e=>{let t=parseFloat(document.getElementById("buyerBalance").innerText.replace("$",""));r.post("/immediateBuy",{itemID:e,buyerBalance:t,buyerUsername:a}).then(e=>{200===e.data.statusCode?(alert(e.data.error),g("")):alert(e.data.error)}).catch(()=>alert("Failed immediate purchase"))};(0,n.useEffect)(()=>{a&&h(a)},[a]);let g=e=>{let a={username:document.getElementById("buyerUsername").innerText};console.log("sending data..."),console.log(a),r.post("/buyerViewItem",a).then(function(e){400===e.data.statusCode?alert(e.data.error):200===e.data.statusCode&&t(e.data.data)}).catch(function(e){alert("Failed")})},p=e=>{let t={buyerUsername:document.getElementById("buyerUsername").innerText};console.log("Sending data:",t),r.post("/closeAccountBuyer",t).then(function(e){400===e.data.statusCode?alert(e.data.error):200===e.data.statusCode&&(alert("Account successfully closed"),window.location.href="https://auctionhouse24.s3.us-east-2.amazonaws.com/login-page.html")}).catch(function(e){alert("Failed")})},B=e=>{let t=document.getElementById("buyerUsername").innerText,a=document.querySelector(".addFunds").value;if(1>Number(a)||!Number.isInteger(Number(a)))return alert("Must enter a WHOLE number that is AT LEAST 1");let s={username:t,funds:a};console.log("Sending data:",s),r.post("/addFunds",s).then(function(e){400===e.data.statusCode?alert(e.data.error):200===e.data.statusCode&&(alert("added funds"),h(t))}).catch(function(e){alert("Failed")})},w=e=>{if(!e)return"";try{if(e=JSON.parse(e),!Array.isArray(e)||0===e.length)return"";return e.reduce((e,t)=>Number(t.amount)>Number(e.amount)?t:e).username||""}catch(e){return""}};return(0,s.jsxs)("main",{className:"buyerMain",children:[(0,s.jsx)("div",{id:"buyerUsername",className:"buyerUsername",children:a}),(0,s.jsx)("div",{id:"buyerBalance",className:"buyerBalance",children:null!==d?"$".concat(d):"Loading balance..."}),(0,s.jsxs)("div",{className:"addBalance",children:[(0,s.jsx)("label",{children:"Add to Balance: "}),(0,s.jsx)("button",{onClick:e=>B(e),children:"Add funds"}),(0,s.jsx)("input",{className:"addFunds",type:"text",placeholder:"$"})]}),(0,s.jsxs)("div",{className:"buyerItems",children:[(0,s.jsx)("button",{className:"reviewItems",onClick:e=>{g(e),u("View Items")},children:"View Items"}),(0,s.jsx)("label",{children:"Items: "})]}),(0,s.jsx)("div",{className:"itemTable",children:e&&e.length>0?(0,s.jsxs)("table",{className:"items",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Item Name"}),(0,s.jsx)("th",{children:"Item Price"}),(0,s.jsx)("th",{children:"Item Description"}),(0,s.jsx)("th",{children:"Item Image"}),(0,s.jsx)("th",{children:"Highest Bid/Bidder"}),(0,s.jsx)("th",{children:"Place Bid"}),(0,s.jsx)("th",{children:"Bidding History"}),(0,s.jsx)("th",{children:"Start Date"}),(0,s.jsx)("th",{children:"End Date"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.itemName}),(0,s.jsx)("td",{children:e.price}),(0,s.jsx)("td",{children:e.description}),(0,s.jsx)("td",{children:(0,s.jsx)("img",{className:"itemImage",src:e.imageUrl})}),(0,s.jsx)("td",{children:w(e.bids)}),(0,s.jsxs)("td",{children:[(0,s.jsx)("button",{className:"placeBid",disabled:"true"===e.buyNow||"View Items"!==i,onClick:()=>j(e.id),children:"Place Bid"}),(0,s.jsx)("input",{disabled:"true"===e.buyNow||"View Items"!==i,id:e.id,className:"placeBidInput",type:"text",placeholder:"$"}),(0,s.jsx)("button",{className:"buyNow",disabled:"false"===e.buyNow||"View Items"!==i,onClick:()=>N(e.id),children:"Buy Now"})]}),(0,s.jsx)("td",{children:(0,s.jsx)("table",{className:"biddingHistory",children:(0,s.jsx)("tbody",{children:(0,s.jsx)("tr",{children:(0,s.jsx)("td",{children:e.bids})})})})}),(0,s.jsx)("td",{children:e.startDate}),(0,s.jsx)("td",{children:e.endDate})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:9,children:(0,s.jsx)("label",{children:"__"})})})]},e.id))})]}):(0,s.jsx)("p",{children:"No items to display"})}),(0,s.jsxs)("div",{className:"sorting",children:[(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{b(a),u("Search Recently Sold")},children:"Search Recently Sold (24 Hrs)"}),(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{x(a),u("Review My Active Bids")},children:"Review My Active Bids"}),(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{u("Review Purchases"),m(a)},children:"Review Purchases"}),(0,s.jsx)("label",{className:"sortLabel",children:"Sort Recently Sold (24 Hrs)"}),(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{u("Name"),y("Name")},children:" Name "}),(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{u("Price"),y("Price")},children:" Price "}),(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{u("Start Date"),y("Start Date")},children:" Start Date "}),(0,s.jsx)("button",{className:"sortingButton",onClick:()=>{u("End Date"),y("End Date")},children:" End Date "})]}),(0,s.jsx)("div",{className:"closeAccount",children:(0,s.jsx)("button",{className:"closeAccountButton",onClick:e=>p(e),children:"Close Account"})})]})}},8306:function(){}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=2242)}),_N_E=e.O()}]);